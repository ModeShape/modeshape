<?xml version="1.0" encoding="UTF-8"?>
<!--
  ~ JBoss DNA (http://www.jboss.org/dna)
  ~
  ~ See the COPYRIGHT.txt file distributed with this work for information
  ~ regarding copyright ownership.  Some portions may be licensed
  ~ to Red Hat, Inc. under one or more contributor license agreements.
  ~ See the AUTHORS.txt file in the distribution for a full listing of 
  ~ individual contributors.
  ~
  ~ JBoss DNA is free software. Unless otherwise indicated, all code in JBoss DNA
  ~ is licensed to you under the terms of the GNU Lesser General Public License as
  ~ published by the Free Software Foundation; either version 2.1 of
  ~ the License, or (at your option) any later version.
  ~
  ~ JBoss DNA is distributed in the hope that it will be useful,
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
  ~ or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public License
  ~ for more details.
  ~
  ~ You should have received a copy of the GNU Lesser General Public License
  ~ along with this distribution; if not, write to:
  ~ Free Software Foundation, Inc.
  ~ 51 Franklin Street, Fifth Floor
  ~ Boston, MA  02110-1301  USA
  -->
<!DOCTYPE preface PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd"	[
<!ENTITY % CustomDTD SYSTEM "../../custom.dtd">
%CustomDTD;
]>
<chapter id="jboss-cache-connector">
  <title>JBoss Cache Connector</title>
  <para>
  	The JBoss Cache repository connector allows a <ulink url="http://www.jboss.org/jbosscache/">JBoss Cache</ulink> instance to be 
		used as a JBoss DNA (and thus JCR) repository.  This provides a repository that is an effective, scalable, and distributed cache,
		and is often paired with other repository sources to provide a local or <link linkend="federation-connector">federated</link>
		repository.
  </para>
	<para>
		The &JBossCacheSource; class provides a number of JavaBean properties that control its behavior:
	</para>
	<table frame='all'>
		<title>&JBossCacheSource; properties</title>
		<tgroup cols='2' align='left' colsep='1' rowsep='1'>
      <colspec colname='c1' colwidth="1*"/>
      <colspec colname='c2' colwidth="1*"/>
			<thead>
				<row>
		  		<entry>Property</entry>
		  		<entry>Description</entry>
				</row>
			</thead>
			<tbody>
				<row>
					<entry>name</entry>
					<entry>The name of the repository source, which is used by the &RepositoryService; when obtaining a &RepositoryConnection; by name.</entry>
				</row>
				<row>
					<entry>cacheFactoryJndiName</entry>
					<entry>Optional property that, if used, specifies the name in JNDI where an existing JBoss Cache Factory instance can be found.
						That factory would then be used if needed to create a JBoss Cache instance.  If no value is provided, then the
						JBoss Cache <code>DefaultCacheFactory</code> class is used.</entry>
				</row>
				<row>
					<entry>cacheConfigurationName</entry>
					<entry>Optional property that, if used, specifies the name of the configuration that is supplied to the cache factory
						when creating a new JBoss Cache instance.</entry>
				</row>
				<row>
					<entry>cacheJndiName</entry>
					<entry>Optional property that, if used, specifies the name in JNDI where an existing JBoss Cache instance can be found.
						This should be used if your application already has a cache that is used, or if you need to configure the cache in
						a special way.</entry>
				</row>
				<row>
					<entry>creatingWorkspacesAllowed</entry>
					<entry>Optional property that is by default 'true' that defines whether clients can create new workspaces.</entry>
				</row>
				<row>
					<entry>defaultCachePolicy</entry>
					<entry>Optional property that, if used, defines the default for how long this information provided by this source may to be 
						cached by other, higher-level components.  The default value of null implies that this source does not define a specific
						duration for caching information provided by this repository source.</entry>
				</row>
				<row>
					<entry>defaultWorkspaceName</entry>
					<entry>Optional property that is initialized to an empty string and which defines the name for the workspace that will be used by default
						if none is specified.</entry>
				</row>
				<row>
					<entry>predefinedWorkspaceNames</entry>
					<entry>Optional property that defines the names of the workspaces that exist and that are available for use without having to create them.</entry>
				</row>
				<row>
					<entry>retryLimit</entry>
					<entry>Optional property that, if used, defines the number of times that any single operation on a &RepositoryConnection; to this source should be retried
						following a communication failure. The default value is '0'.</entry>
				</row>
				<row>
					<entry>rootNodeUuid</entry>
					<entry>Optional property that, if used, specifies the UUID that should be used for the root node of each workspace.  If no value is
					specified, a random UUID is generated each time that the repository is started.</entry>
				</row>	
				<row>
					<entry>uuidPropertyName</entry>
					<entry>Optional property that, if used, defines the property that should be used to find the UUID value for each node
						in the cache.  "<code>dna:uuid</code>" is the default.</entry>
				</row>
				
			</tbody>
		</tgroup>
	</table>
	<para>
		The JBoss Cache connector is used by creating in the &JcrConfiguration; a repository source that uses the &JBossCacheSource; class.
		For example:
	</para>
  <programlisting role="JAVA"><![CDATA[
JcrConfiguration config = ...
config.repositorySource("source A")
      .usingClass(JBossCacheSource.class)
      .setDescription("The repository for our content")      
      .setProperty("defaultWorkspaceName", "prod")
      .setProperty("rootNodeUuid", UUID.fromString("12083e7e-2b55-4c8d-954d-627a9f5c45c2"))
      .setProperty("predefinedWorkspaceNames", new String[] { "staging", "dev"});
 ]]></programlisting>
 </chapter>

